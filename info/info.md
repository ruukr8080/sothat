# enum OAuthAttributes

해당 클래스의 경우, 현재 로그인하고 있는 계정이 어느 서비스인지를 나타내는 registrationId,
현재 로그인하고 있는 사용자의 정보를 저장하고있는 attirbute을 제시하면, 사용자의 정보를 담고 있는 UserProfile를 반환하는 Function 인터페이스로 구성되어 있습니다.

extract() 메소드가 바로 그 예시인데, 일단 values()를 통하여 로그인한 사용자가 가지고 있는 권한들을 스트림으로 변화시키는데, 입력받은 매개변수 registrationId와 일치하는 사용자 권한을 찾을 수 없는 경우, 해당 서비스는 올바르지 않은 서비스라고 판단하여 오류를 반환하도록 설정하였습니다.

만약 정보가 일치한다면, apply() 메소드를 통하여 attibute를 사용하는데, 이 경우 attribute의 값에 해당하는 UserProfile이 반환됩니다.

값에 해당하는 UserProfile의 경우, 각 서비스들마다 반환되는 값의 형태가 다르기때문에 코드의 형태가 다른 것을 확인할 수 있었습니다.


# OAuth2Service

마지막으로 사용자의 로그인이 성공하였을경우 실행되는 OAuth2Service 로직입니다.

아까는 틀만 만들어주었으나, 이번에는 로직까지 모두 구현해주었습니다.

2개의 메소드를 생성하여 적용하였는데, 먼저 getCustomAttribute() 메소드의 경우에는 사용자의 정보를 담고 있는 attribute의 경우 수정이 불가능하다는 특성을 가지고 있기 때문에, 사용자 임의로 변화시키고 싶은 부분을 수정하기 위하여 별도로 메소드를 만들어주었습니다.

updateOrSaveUser() 메소드의 경우, 데이터베이스에 User 객체가 존재하지 않는 경우에는 UserProfile을 토대로 User Entity를 생성해주고, 그렇지 않은 경우에는 이름과 이메일을 업데이트해주는 메소드입니다.


